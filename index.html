<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScoreMaster AI - Final Fix</title>
    <style>
        :root { --p: #4f46e5; --bg: #f3f4f6; }
        body { font-family: sans-serif; background: var(--bg); padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-ai { background: #10b981; color: white; }
        .btn-add { background: var(--p); color: white; }
        .btn-calc { background: #1e293b; color: white; }
        .player { background: #f9fafb; padding: 10px; border-radius: 8px; margin-top: 10px; border: 1px solid #eee; }
        #status { text-align: center; font-size: 0.8rem; margin-top: 10px; color: #666; }
    </style>
</head>
<body>

<div style="max-width: 500px; margin: 0 auto;">
    <h2 style="text-align:center;">üèÜ ScoreMaster AI</h2>

    <div class="card">
        <textarea id="rules" rows="2" placeholder="Nom du jeu (ex: Scrabble)"></textarea>
        <button class="btn-ai" onclick="askAI()">‚öôÔ∏è Configurer avec l'IA</button>
        <div id="status">Pr√™t.</div>
    </div>

    <div class="card">
        <div style="display:flex; gap:5px;">
            <input type="text" id="pName" placeholder="Nom joueur" style="flex:1; padding:10px; border-radius:8px; border:1px solid #ddd;">
            <button class="btn-add" onclick="addP()" style="width:50px; margin-top:0;">+</button>
        </div>
        <div id="list"></div>
        <button class="btn-calc" onclick="calc()">Calculer le gagnant</button>
        <div id="win" style="display:none; margin-top:15px; text-align:center; font-weight:bold; color:green;"></div>
    </div>
</div>

<script>
    const API_KEY = "AIzaSyBz-hjRxMNXjheqJb3d4_awpvYZw06ozjY";
    
    // Liste des mod√®les possibles par ordre de probabilit√© pour votre compte
    const MODELS = [
        "gemini-2.0-flash-exp", 
        "gemini-1.5-flash",
        "gemini-1.5-flash-8b"
    ];

    async function testIA() {
        const status = document.getElementById('status');
        const debug = document.getElementById('debug');
        const game = document.getElementById('gameName').value || "Jeu standard";

        status.innerText = "‚è≥ Recherche du mod√®le compatible...";
        debug.style.display = "none";

        // On boucle sur les mod√®les pour trouver celui qui r√©pond
        for (let model of MODELS) {
            try {
                const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${API_KEY}`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `R√©ponds 'OK' pour le jeu ${game}` }] }]
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    status.innerText = `‚úÖ R√âUSSITE avec le mod√®le : ${model}`;
                    debug.style.display = "block";
                    debug.style.background = "#d1fae5";
                    debug.style.color = "#065f46";
                    debug.innerText = "L'IA est connect√©e et op√©rationnelle !";
                    return; // On arr√™te d√®s que √ßa marche
                } else {
                    console.log(`Mod√®le ${model} non trouv√©, essai suivant...`);
                }
            } catch (err) {
                console.error("Erreur r√©seau pour " + model);
            }
        }

        // Si on arrive ici, aucun mod√®le n'a fonctionn√©
        status.innerText = "‚ùå Aucun mod√®le trouv√©";
        debug.style.display = "block";
        debug.innerText = "V√©rifiez dans AI Studio quel est le nom exact du mod√®le s√©lectionn√© dans votre interface (en haut √† droite).";
    }
</script>

</body>

</html>

